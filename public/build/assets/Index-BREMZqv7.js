import{K as Y,r as d,m as Z,j as e,L as ee}from"./app-DcneQE3y.js";import{I as se}from"./input-CS08_VC6.js";import{L as ae}from"./label-C1MJqpT0.js";import{S as te,a as le,b as re,c as ne,d as ie}from"./select-1PkxQEl0.js";import{T as oe}from"./use-mobile-navigation-PdNF5KYm.js";import{D as ce}from"./decision-tree-model-DGPQ5HyE.js";import{B as V,c as v,b as de}from"./proxy-CepMwaQ6.js";import{L as A}from"./loader-circle-BZ1rsAcM.js";import{C as me}from"./card-NFv8WVE_.js";import{C as xe,a as ue}from"./react-icons.esm-a2hNxGTB.js";import{A as he}from"./app-layout--lLQW3o0.js";import"./index-Q_OI6t_I.js";import"./index-DIYsINuK.js";import"./check-BQJQqpja.js";import"./chart-column-CAesDUkv.js";import"./baby-DOoyboyW.js";const fe=({kriteria:s,setResult:n,setFeature:u,canEvaluate:j=!1})=>{const{auth:C}=Y().props,[b,o]=d.useState(!1),[S,w]=d.useState(null),[c]=d.useState(new ce),[a,B]=d.useState(null),[p,g]=d.useState(null),{data:m,setData:i,processing:D}=Z({label:"",kriteria:s.map(()=>"")}),[P,z]=d.useState({title:"",show:!1,message:"",type:"success"}),H=d.useCallback(t=>{const{name:r,value:l}=t.target,[x,N]=r.split("."),y=Number(N);x==="kriteria"?(l===""||/^-?\d*\.?\d*$/.test(l))&&i(k=>{var $;const h=($=k.kriteria)==null?void 0:$.map((f,L)=>L===y?l:f),E=s.findIndex(f=>f.nama.toLowerCase().includes("bb")),R=s.findIndex(f=>f.nama.toLowerCase().includes("tb")),F=s.findIndex(f=>f.nama.toLowerCase().includes("imt"));if((y===E||y===R)&&F!==-1){const f=Number(y===E?l:(h==null?void 0:h[E])??0),L=Number(y===R?l:(h==null?void 0:h[R])??0);if(f>0&&L>0)return{...k,kriteria:h==null?void 0:h.map((W,X)=>X===F?J(f,L):W)}}return{...k,kriteria:h}}):i(k=>({...k,[r]:l}))},[s,i]),J=(t,r)=>{const l=r/100;return(t/(l*l)).toFixed(3)},K=d.useCallback((t,r)=>{i(t==="label"?l=>({...l,[t]:r}):l=>({...l,kriteria:l.kriteria.map((x,N)=>N===Number(t)?r:x)}))},[i]);d.useEffect(()=>{(async()=>{o(!0);try{const r=await c.fetchAndProcessData();await c.loadModel(),w(r)}catch(r){console.error(r)}finally{o(!1)}})()},[]);const _=async()=>{o(!0);try{await c.trainModel();const t=await c.evaluateModel();await c.saveModel(),g(t)}catch(t){console.error(t)}finally{o(!1)}},U=async t=>{t.preventDefault(),o(!0);try{const r=m.kriteria.map(x=>{const N=String(x).toLowerCase();return N==="laki-laki"?0:N==="perempuan"?1:!isNaN(parseFloat(x))&&isFinite(x)?parseFloat(x):x}),l=await c.predict([r]);console.log(l),B(l),u&&u(m.kriteria),l.label!==void 0&&n&&n({prediction:(a==null?void 0:a.prediction)??0,label:(a==null?void 0:a.label)??"tidak dikenali",rekomendasi:(a==null?void 0:a.rekomendasi)??"Label tidak dikenali",error:(a==null?void 0:a.error)??"Label tidak dikenali"})}catch(r){console.error(r),z({title:"Hasil Prediksi",show:!0,message:r,type:"success"})}finally{o(!1)}};c.getDataLoadingState(),c.getTrainingState(),c.getEvaluationState(),c.getPredictionState();const Q=d.useMemo(()=>{if(!a)return"";switch(a.label){case"Buruk":return"bg-red-100 border-red-300 text-red-800";case"Cukup":return"bg-yellow-100 border-yellow-300 text-yellow-800";case"Baik":return"bg-green-100 border-green-300 text-green-800";default:return"bg-blue-100 border-blue-300 text-blue-800"}},[a]);return e.jsxs("div",{className:"mx-auto max-w-7xl px-4 py-8",children:[e.jsx(oe,{open:P.show,onOpenChange:()=>z(t=>({...t,show:!1})),title:P.title,description:P.message,duration:5e3,variant:P.type}),e.jsxs("div",{className:"grid grid-cols-1 overflow-hidden rounded-xl border border-gray-100 bg-white shadow-sm md:grid-cols-2",children:[e.jsx("div",{className:"p-6 ring-1 md:p-8",children:e.jsxs("form",{onSubmit:t=>U(t),className:"space-y-6",children:[e.jsx("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2",children:s.map((t,r)=>e.jsxs("div",{className:"space-y-2",children:[e.jsx(ae,{className:"text-sm font-medium text-gray-700",children:t.nama.charAt(0).toUpperCase()+t.nama.slice(1)}),t.nama.toLowerCase()==="jenis kelamin"?e.jsxs(te,{value:m.kriteria[r]||"",required:!0,onValueChange:l=>K(r.toString(),l),children:[e.jsx(le,{className:"w-full",children:e.jsx(re,{placeholder:"Select Jenis Kelamin"})}),e.jsx(ne,{children:["Laki-laki","Perempuan"].map((l,x)=>e.jsx(ie,{value:l,children:l},x))})]}):e.jsx(se,{type:"text",name:`kriteria.${r}`,value:m.kriteria[r]||"",onChange:H,placeholder:`Enter ${t.nama}`,disabled:D,required:!0})]},r))}),e.jsxs("div",{className:"flex flex-wrap gap-3 pt-4",children:[(C.role==="admin"||C.role==="super_admin"&&j)&&e.jsxs(V,{type:"button",variant:"outline",onClick:_,disabled:b,children:[b?e.jsx(A,{className:"mr-2 h-4 w-4 animate-spin"}):null,"Train Model"]}),e.jsxs(V,{type:"submit",disabled:b||!c,className:"bg-gradient-to-r from-green-600 to-green-500 hover:from-green-700 hover:to-green-600",children:[b?e.jsx(A,{className:"mr-2 h-4 w-4 animate-spin"}):null,"Mulai Rekomendasi"]})]})]})}),e.jsxs("div",{className:"p-6 md:p-8",children:[a?e.jsx("div",{className:`border ${Q} p-6 transition-all duration-300`,children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`h-5 w-5 flex-shrink-0 rounded-full ${a.label==="Buruk"?"bg-red-500":a.label==="Cukup"?"bg-yellow-500":a.label==="Baik"?"bg-green-500":"bg-blue-500"}`}),e.jsxs("div",{className:"ml-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"status gizi anak"}),e.jsx("div",{className:"mt-1 text-2xl font-bold",children:a.label})]})]})}):e.jsx("div",{className:"border border-gray-200 p-6 transition-all duration-300",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-5 w-5 flex-shrink-0 rounded-full bg-gray-500"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"status gizi anak"}),e.jsx("div",{className:"mt-1 text-2xl font-bold",children:"-"})]})]})}),p&&e.jsx("div",{className:"border p-6 transition-all duration-300",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-5 w-5 flex-shrink-0 rounded-full bg-green-500"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Hasil Evaluasi Model"}),e.jsxs("div",{className:"mt-1 text-2xl font-bold",children:[p.accuracy*100," %"]})]})]})})]})]})]})},O=({className:s,...n})=>e.jsx("nav",{role:"navigation","aria-label":"pagination",className:v("mx-auto flex w-full justify-center",s),...n});O.displayName="Pagination";const T=d.forwardRef(({className:s,...n},u)=>e.jsx("ul",{ref:u,className:v("flex flex-row items-center gap-1",s),...n}));T.displayName="PaginationContent";const I=d.forwardRef(({className:s,...n},u)=>e.jsx("li",{ref:u,className:v("",s),...n}));I.displayName="PaginationItem";const M=({className:s,isActive:n,size:u="icon",...j})=>e.jsx("a",{"aria-current":n?"page":void 0,className:v(de({variant:n?"outline":"ghost",size:u}),s),...j});M.displayName="PaginationLink";const q=({className:s,...n})=>e.jsxs(M,{"aria-label":"Go to previous page",size:"default",className:v("gap-1 pr-2.5 w-max",s),...n,children:[e.jsx(xe,{className:"h-4 w-4"}),e.jsx("span",{children:"Sebelumnya"})]});q.displayName="PaginationPrevious";const G=({className:s,...n})=>e.jsxs(M,{"aria-label":"Go to next page",size:"default",className:v("gap-1 pl-2.5 w-max",s),...n,children:[e.jsx("span",{children:"Selanjutnya"}),e.jsx(ue,{className:"h-4 w-4"})]});G.displayName="PaginationNext";function De({dataTraining:s,breadcrumb:n,titlePage:u,kriteria:j,jenisTanaman:C}){const b=d.useMemo(()=>n?n.map(g=>({title:g.title,href:g.href})):[],[n]),[o,S]=d.useState(1),w=5,c=o*w,a=c-w,B=s==null?void 0:s.training.slice(a,c),p=Math.ceil((s==null?void 0:s.training.length)/w);return e.jsxs(he,{breadcrumbs:b,children:[e.jsx(ee,{title:u??"Indikator"}),e.jsx(me,{children:e.jsxs("div",{className:"container mx-auto overflow-hidden px-4 py-4",children:[e.jsx("div",{className:"mb-4 flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:e.jsx("h2",{className:"text-lg font-bold md:text-xl",children:"Algoritma Decision Tree"})}),j&&C&&e.jsxs("div",{className:"mt-6",children:[e.jsxs("div",{className:"mb-10 text-center",children:[e.jsx("h1",{className:"mb-2 text-4xl font-bold text-gray-800",children:"Nutrisi Rekomendasi"}),e.jsx("p",{className:"mx-auto max-w-2xl text-gray-600",children:"Rekomendasi Jenis Sayuran Berdasarkan Nutrisi untuk Anak"})]}),e.jsx(fe,{kriteria:j,canEvaluate:!0})]}),s&&e.jsxs("div",{className:"mt-4",children:[e.jsx("h3",{className:"text-md mb-2 font-semibold",children:"Data Training"}),e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("table",{className:"min-w-full border bg-white",children:[e.jsx("thead",{children:e.jsx("tr",{children:s.kriteria.map((g,m)=>e.jsx("th",{className:"border px-4 py-2",children:g},m))})}),e.jsx("tbody",{children:B.map((g,m)=>e.jsx("tr",{children:g.map((i,D)=>e.jsx("td",{className:"border px-4 py-2",children:i},D))},m))})]}),e.jsxs("div",{className:"mt-4 flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{className:"order-2 text-xs whitespace-nowrap text-gray-500 sm:order-1 md:text-sm",children:["Showing ",a+1," to ",Math.min(c,s.training.length)," of"," ",s.training.length," entries"]}),e.jsx(O,{className:"order-1 sm:order-2",children:e.jsxs(T,{className:"flex-wrap justify-center",children:[e.jsx(I,{children:e.jsx(q,{onClick:()=>S(Math.max(1,o-1)),className:o===1?"pointer-events-none opacity-50":"",size:void 0})}),Array.from({length:Math.min(p,5)},(g,m)=>{let i;return p<=5||o<=3?i=m+1:o>=p-2?i=p-4+m:i=o-2+m,e.jsx(I,{children:e.jsx(M,{isActive:i===o,onClick:()=>S(i),size:void 0,children:i})},i)}),e.jsx(I,{children:e.jsx(G,{onClick:()=>S(Math.min(p,o+1)),className:o===p?"pointer-events-none opacity-50":"",size:void 0})})]})})]})]})]})]})})]})}export{De as default};
